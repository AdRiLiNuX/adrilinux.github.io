<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>syst√®me on AdRiLiNuX's web site</title><link>https://www.reslinger.net/categories/syst%C3%A8me/</link><description>Recent content in syst√®me on AdRiLiNuX's web site</description><generator>Hugo -- gohugo.io</generator><language>fr-fr</language><lastBuildDate>Fri, 21 Aug 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://www.reslinger.net/categories/syst%C3%A8me/index.xml" rel="self" type="application/rss+xml"/><item><title>Mode rescue OVH</title><link>https://www.reslinger.net/2020/08/mode-rescue-ovh/</link><pubDate>Fri, 21 Aug 2020 00:00:00 +0000</pubDate><guid>https://www.reslinger.net/2020/08/mode-rescue-ovh/</guid><description>&lt;p>Pour des raisons de co√ªt; mon infra repose sur de petits serveurs d√©di√©s √† prix promotionnel. J&amp;rsquo;en ai actuellement un chez SoYouStart, mais ce qui suis est √©galement valable pour des serveurs d√©di√©s chez OVH (ainsi que Kimsufi).
Une des particularit√©s des serveurs d√©di√©s pas cher, c&amp;rsquo;est qu&amp;rsquo;il n&amp;rsquo;y a pas syst√©matiquement de carte d&amp;rsquo;acc√®s √† distance type Ilo ou Drac. Chez OVH, nous avons un syst√®me de rescue qui peut nous aider lorsque le serveur √† un s√©rieux probl√®me.&lt;/p>
&lt;p>Lors d&amp;rsquo;un simple reboot, j&amp;rsquo;ai perdu la main sur mon serveur, j&amp;rsquo;ai donc lancer le mode rescue.
Une fois ce mode d√©marrer, on peut se connecter sur un syst√®me temporaire bas√© sur Debian en SSH pour essayer de comprendre ce qui ne va pas.
Petite parenth√®se, un service web tourne sur le port 81 du syst√®me et permet de faire quelques test mat√©riel. Les identifiants sont les m√™me qu&amp;rsquo;avec SSH (utilisateur root, mot de passe re√ßu par mail).&lt;/p>
&lt;p>Le billet du jour √† pour propos de traiter la collecte d&amp;rsquo;informations pour le d√©boguage de la s√©quence de boot.&lt;/p>
&lt;p>Mon syst√®me fonctionnait parfaitement avant que je le relance, le probl√®me est li√© √† la s√©quence de boot et non √† une panne mat√©riel. Depuis la console SSH du mode rescue, j&amp;rsquo;installe donc le n√©cessaire pour voir la s√©quence de boot. Le n√©cessaire est la virtualisation. C&amp;rsquo;est parti.&lt;/p>
&lt;p>Par habitude, je commence par mettre le syst√®me √† jour&lt;/p>
&lt;pre>&lt;code>apt update; apt upgrade -y
&lt;/code>&lt;/pre>
&lt;p>Je d√©sactive le RAID disque de mes disques pour √©vit√© d&amp;rsquo;avoir 2 syst√®mes qui acc√®dent aux m√™mes donn√©es&lt;/p>
&lt;pre>&lt;code>mdadm --manage --stop /dev/md127
&lt;/code>&lt;/pre>
&lt;p>Ensuite j&amp;rsquo;installe le n√©cessaire pour lancer mon syst√®me dans une machine virtuelle&lt;/p>
&lt;pre>&lt;code>apt install qemu-kvm libvirt-bin ovmf virtinst -y
&lt;/code>&lt;/pre>
&lt;p>Et je lance la virtualisation de mon syst√®me&lt;/p>
&lt;pre>&lt;code>systemctl start libvirtd
virsh net-start default
virt-install --name rescue --hvm --vcpus=4 --ram 8192 --machine q35 --disk path=/dev/sda,bus=virtio,format=raw --disk path=/dev/sdb,bus=virtio,format=raw --disk path=/dev/sdc,bus=virtio,format=raw --disk path=/dev/sdd,bus=virtio,format=raw --network network:default,model=virtio --graphics spice --video qxl --channel spicevmc --rng /dev/random --noautoconsole --console pty,target_type=serial --os-type=linux --os-variant=rhel7 --import
&lt;/code>&lt;/pre>
&lt;p>Si la configuration de votre grub permet le contr√¥le depuis le port s√©rie, vous pouvez y acc√©der directement &lt;a href="https://www.reslinger.net/2014/12/console-virsh/">depuis la console&lt;/a>. Autrement, installez les paquets suivant&lt;/p>
&lt;pre>&lt;code>apt install virt-manager xauth
&lt;/code>&lt;/pre>
&lt;p>Apr√®s vous √™tre reloggu√©, vous pourrez lancer virt-manager et avoir acc√®s √† la console et voir enfin pourquoi votre syst√®me ne d√©marre plus.&lt;/p></description></item><item><title>Copie d'image Docker</title><link>https://www.reslinger.net/2020/07/copie-dimage-docker/</link><pubDate>Wed, 01 Jul 2020 00:00:00 +0000</pubDate><guid>https://www.reslinger.net/2020/07/copie-dimage-docker/</guid><description>&lt;p>Petit tips Docker pour copier une image d&amp;rsquo;un registre √† un autre.&lt;/p>
&lt;p>De temps en temps on a besoin de sortir une image docker d&amp;rsquo;un registre priv√© dans un autre registre (priv√© ou publique). Bien que les commande pull et push sont g√©n√©ralement connue, la commande manquant est un retag. L&amp;rsquo;op√©ration globale donne donc ceci:&lt;/p>
&lt;pre>&lt;code>docker image pull ancien-registre/application:tag
docker tag ancien-registre/application:tag nouveau-registre/application:tag
docker push nouveau-registre/application:tag
&lt;/code>&lt;/pre>
&lt;p>Source: &lt;a href="https://stackoverflow.com/questions/49976188/copy-docker-image-between-repositories">stackoverflow&lt;/a>&lt;/p></description></item><item><title>Chiffrer son homedir sous Ubuntu</title><link>https://www.reslinger.net/2018/02/chiffrer-son-homedir-sous-ubuntu/</link><pubDate>Tue, 06 Feb 2018 00:00:00 +0000</pubDate><guid>https://www.reslinger.net/2018/02/chiffrer-son-homedir-sous-ubuntu/</guid><description>&lt;p>Bonjour,&lt;/p>
&lt;p>J&amp;rsquo;avais sous la main une machine sous Ubuntu Xenial (16.04 LTS) o√π je voulais activer le chiffrage du homedir car je ne l&amp;rsquo;avais pas fait durant l&amp;rsquo;installation du syst√®me. Pourquoi ? Simplement par ce que j&amp;rsquo;installe des syst√®mes sur disque chiffr√©. Je pensais alors que c'√©tait suffisant.
La machine que j&amp;rsquo;ai voulu modifier est en fait une machine potentiellement partag√©e aujourd&amp;rsquo;hui, les besoins ont donc chang√©s. Voyons tout de suite comment effectuer ces manipulations (apr√®s avoir fait une sauvegarde du homedir, il en va sans dire).&lt;/p>
&lt;p>Pour l&amp;rsquo;installation des paquets :&lt;/p>
&lt;pre>&lt;code>apt install ecryptfs-utils libpam-mount
&lt;/code>&lt;/pre>
&lt;p>Pour l&amp;rsquo;encryption du homedir :&lt;/p>
&lt;pre>&lt;code>ecryptfs-migrate-home -u $MON_USER
&lt;/code>&lt;/pre>
&lt;p>Enfin, sans red√©marrer la machine, il est recommand√© de se connecter tout de suite √† sa session pour v√©rifier le bon d√©roul√© et y taper la commande suivante pour avoir le passe de r√©cup√©ration :&lt;/p>
&lt;pre>&lt;code>ecryptfs-migrate-home -u mon_user
&lt;/code>&lt;/pre>
&lt;p>L&amp;rsquo;op√©ration de chiffrement √©tant valid√©e, vous pourez supprimer le r√©pertoire de sauvegarde r√©alis√© dans le r√©pertoire /home .&lt;/p>
&lt;p>Source utilis√©e: &lt;a href="https://doc.ubuntu-fr.org/ecryptfs">ecryptfs sur ubuntu-fr&lt;/a>&lt;/p></description></item><item><title>Console virsh</title><link>https://www.reslinger.net/2014/12/console-virsh/</link><pubDate>Wed, 03 Dec 2014 00:00:00 +0000</pubDate><guid>https://www.reslinger.net/2014/12/console-virsh/</guid><description>&lt;p>Bonjour,&lt;/p>
&lt;p>Aujourd&amp;rsquo;hui, rien de passionnant, juste un petit m√©mo pour l&amp;rsquo;entrer dans une machine virtuelle pilot√©e par libvirt, mais surtout le raccourcis pour en ressortir.&lt;/p>
&lt;p>Pour entrer :&lt;/p>
&lt;pre>&lt;code>virsh console VM
&lt;/code>&lt;/pre>
&lt;p>Pour sortir&lt;/p>
&lt;pre>&lt;code>Ctrl + ]
&lt;/code>&lt;/pre>
&lt;p>Bien sur, il faut que le syst√®me invit√© soit configur√© pour avoir une console sur le port s√©rie.&lt;/p></description></item><item><title>D√©sactiver le choix du navigateur</title><link>https://www.reslinger.net/2014/08/d%C3%A9sactiver-le-choix-du-navigateur/</link><pubDate>Sun, 17 Aug 2014 00:00:00 +0000</pubDate><guid>https://www.reslinger.net/2014/08/d%C3%A9sactiver-le-choix-du-navigateur/</guid><description>&lt;p>Bonjour tout le monde.&lt;/p>
&lt;p>Si vous √™tes comme moi √† installer un Windows de temps en temps , alors vous avez d√ª aussi remarquer qu'√† un moment donn√© une boite de dialogue appara√Æt demandant de choisir son navigateur. Sur une machine d&amp;rsquo;administration qui ne d√©marre qu&amp;rsquo;une fois par an, installer un autre navigateur qui sera de toute fa√ßon obsol√®te au d√©marrage suivant n&amp;rsquo;est pas forc√©ment judicieux. La probl√©matique qui se pose alors est de d√©sactiver cette fameuse boite de dialogue.&lt;/p>
&lt;p>Pour de faire, il faut ajouter via un √©diteur de base de registre, un Nouveau DWORD dans &amp;ldquo;HKEY_LOCAL_MACHINE\Software\BrowserChoice&amp;rdquo; du nom de &amp;ldquo;Enable&amp;rdquo;. Sa valeur sera 0 pour le d√©sactiver, 1 pour le r√©activer.&lt;/p>
&lt;p>Ensuite, la machine d√©marre plus vite üôÇ&lt;/p></description></item></channel></rss>